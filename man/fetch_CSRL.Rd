% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fetch_CSRL.R
\name{fetch_CSRL}
\alias{fetch_CSRL}
\title{Download and Process CSRL Soil Property Data}
\usage{
fetch_CSRL(
  aoi,
  properties,
  depths = NULL,
  output_dir = NULL,
  suffix = "",
  crs = "EPSG:4326",
  scale = 800,
  tosoc = FALSE,
  export = TRUE
)
}
\arguments{
\item{aoi}{SpatRaster, SpatVector, or file path to a shapefile. The area of interest.}

\item{properties}{Character vector. List of soil properties to download (see **Lookup Table** below).}

\item{depths}{Character vector. Depth intervals to download (e.g., `"0-5"`, `"0-25"`, `"30-60"`).
Required only for `_profile` properties.}

\item{output_dir}{Character. Directory where files will be saved. Set to `NULL` to keep only in memory.}

\item{suffix}{Character. Optional suffix for file names.}

\item{crs}{Character. Coordinate reference system for the output. Default is `"EPSG:4326"`.}

\item{scale}{Numeric. Resolution in meters. Default is `800` (coarse for regional analysis).}

\item{tosoc}{Logical. If `TRUE`, converts Organic Matter (`som` or `som_max`) 
to Soil Organic Carbon (SOC) using the Van Bemmelen factor (1.724).}

\item{export}{Logical. If `TRUE`, saves downloaded rasters to `output_dir`. Default is `TRUE`.}
}
\value{
A list containing:
\describe{
  \item{\code{stack}}{A `SpatRaster` containing all downloaded layers.}
  \item{\code{file_paths}}{A character vector of file paths (if `export = TRUE`).}
  \item{\code{product}}{A character string `"CSRL"` identifying the dataset.}
}
}
\description{
Downloads specified soil property data from the **CSRL Soil Properties Dataset** on Google Earth Engine (GEE),
loads the rasters into memory, and optionally saves them to disk.
}
\details{
**⚠️ Note:** This dataset is intended for **statewide and regional soil analysis**.  
For **local-scale, fine-resolution soil data**, refer to **SSURGO (Soil Survey Geographic Database)**.


This function accesses the **CSRL Soil Properties Dataset** in **Google Earth Engine (GEE)**,  
providing **bulk density, cation exchange capacity (CEC), sand/silt/clay fractions, soil organic matter (SOM),  
saturated hydraulic conductivity (Ksat), pH, and other soil properties**.  

**Important:** `_profile` datasets represent **multi-depth image collections**.  
You must specify a `depth` for `_profile` properties (e.g., `"0-25"`, `"30-60"`).

## **CSRL Soil Property Lookup Table**
\tabular{lll}{
**Category**   \tab **Property Name**        \tab **Use Depths?**  \cr
**Chemical**   \tab `"caco3"`                \tab ❌ No            \cr
              \tab `"cec"`                   \tab ❌ No            \cr
              \tab `"cec_profile"`           \tab ✅ Yes (`0-5`, `0-25`, `0-50`) \cr
              \tab `"ec"`                    \tab ❌ No            \cr
              \tab `"ph_profile"`            \tab ✅ Yes (`0-5`, `0-25`, `25-50`, `30-60`) \cr
              \tab `"sar"`                   \tab ❌ No            \cr
              \tab `"som"`                   \tab ❌ No            \cr
**Physical**   \tab `"bulk_density"`         \tab ❌ No            \cr
              \tab `"clay_profile"`          \tab ✅ Yes (`0-5`, `0-25`, `25-50`, `30-60`) \cr
              \tab `"ksat_max"`              \tab ❌ No            \cr
              \tab `"sand_profile"`          \tab ✅ Yes (`0-5`, `0-25`, `25-50`, `30-60`) \cr
              \tab `"silt_profile"`          \tab ✅ Yes (`0-5`, `0-25`, `25-50`, `30-60`) \cr
**Land Use**   \tab `"soil_order"`           \tab ❌ No            \cr
              \tab `"soil_temp_regime"`      \tab ❌ No            \cr
              \tab `"wind_erodibility_group"`\tab ❌ No            \cr
}
}
\examples{
\dontrun{
# Load required libraries
library(terra)
library(sf)
# Authenticate and initialize Google Earth Engine
gd_authenticate(auth_mode = "notebook")
gd_initialize()

# Define AOI and output directory
output_directory <- "path/to/output"
aoi_raster <- rast("path_to_aoi.tif")

# Fetch CSRL soil data (Profile & Non-Profile Properties)
csrl_data <- fetch_CSRL(
  aoi = aoi_raster,
  properties = c("sand_profile", "caco3", "ksat_max"),
  depths = c("0-25", "30-60"),  # Required only for profile datasets
  output_dir = output_directory,
  scale = 800,  # Default - for regional analysis
  suffix = "",
  export = TRUE
)

# View downloaded raster stack
plot(csrl_data$stack)
}
}
